#:schema node_modules/wrangler/config-schema.json

name = "contextgrade-api"
main = "src/worker.ts"
compatibility_date = "2026-02-26"
compatibility_flags = ["nodejs_compat"]

[observability]
enabled = true

[vars]
NODE_ENV = "production"
LOG_LEVEL = "info"
PORT = "8080"
HOST = "0.0.0.0"

# Force pino to its Node.js entry — wrangler defaults to the browser
# entry (which lacks `symbols`) because Workers is browser-like.
[alias]
pino = "./node_modules/pino/pino.js"

[build]
command = "npx prisma generate"

[[hyperdrive]]
binding = "HYPERDRIVE"
id = "09fb18930f5c45bf8e8256bbab6f761b"

# ─── Secrets ────────────────────────────────────────────────
# NEVER put secrets in this file. Use one of:
#
#   Local dev:   .dev.vars   (gitignored, loaded by `wrangler dev`)
#   Production:  wrangler secret put <KEY>
#
# Required secrets:
#   DATABASE_URL
#   SUPABASE_URL
#   SUPABASE_PUBLISHABLE_DEFAULT_KEY
#   API_KEY
#
# Optional secrets:
#   SUPABASE_SECRET_KEY
#   OPENAI_API_KEY
#   ANTHROPIC_API_KEY
